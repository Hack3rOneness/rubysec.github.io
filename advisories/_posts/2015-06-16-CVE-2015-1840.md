---
layout: advisory
title: ! 'CVE-2015-1840 (jquery-ujs): CSRF Vulnerability in jquery-ujs'
comments: false
categories:
- jquery-ujs
advisory:
  gem: jquery-ujs
  cve: 2015-1840
  url: https://groups.google.com/forum/#!topic/ruby-security-ann/XIZPbobuwaY
  title: CSRF Vulnerability in jquery-ujs
  date: 2015-06-16
  description: ! "In the scenario where an attacker might be able to control the href
    attribute\nof an anchor tag or the action attribute of a form tag that will trigger
    a\nPOST action, the attacker can set the href or action to\n\" https://attacker.com\"
    (note the leading space) that will be passed to\nJQuery, who will see this as
    a same origin request, and send the user's CSRF\ntoken to the attacker domain.\n\nTo
    work around this problem, change code that allows users to control the\nhref attribute
    of an anchor tag or the action attribute of a form tag to\nfilter the user parameters.\n\nFor
    example, code like this:\n\n  link_to params\n\nto code like this:\n\n  link_to
    filtered_params\n\n  def filtered_params\n    \\# Filter just the parameters that
    you trust\n  end\n\nSee also:\n- http://blog.honeybadger.io/understanding-the-rails-jquery-csrf-vulnerability-cve-2015-1840/\n"
  cvss_v2: 5.0
  patched_versions:
  - ! '>= 1.0.4'
---
