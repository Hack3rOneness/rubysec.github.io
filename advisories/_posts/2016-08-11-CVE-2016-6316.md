---
layout: advisory
title: ! 'CVE-2016-6316 (actionview): Possible XSS Vulnerability in Action View'
comments: false
categories:
- actionview
- rails
advisory:
  gem: actionview
  framework: rails
  cve: 2016-6316
  date: 2016-08-11
  url: https://groups.google.com/forum/#!topic/rubyonrails-security/I-VWr034ouk
  title: Possible XSS Vulnerability in Action View
  description: ! "There is a possible XSS vulnerability in Action View.  Text declared
    as \"HTML\nsafe\" will not have quotes escaped when used as attribute values in
    tag\nhelpers.\n\nImpact\n------\n\nText declared as \"HTML safe\" when passed
    as an attribute value to a tag helper\nwill not have quotes escaped which can
    lead to an XSS attack.  Impacted code\nlooks something like this:\n\n```ruby\ncontent_tag(:div,
    \"hi\", title: user_input.html_safe)\n```\n\nSome helpers like the `sanitize`
    helper will automatically mark strings as\n\"HTML safe\", so impacted code could
    also look something like this:\n\n```ruby\ncontent_tag(:div, \"hi\", title: sanitize(user_input))\n```\n\nAll
    users running an affected release should either upgrade or use one of the\nworkarounds
    immediately.\n\nWorkarounds\n-----------\nYou can work around this issue by either
    *not* marking arbitrary user input as\nsafe, or by manually escaping quotes like
    this:\n\n```ruby\ndef escape_quotes(value)\n  value.gsub(/\"/, '&quot;'.freeze)\nend\n\ncontent_tag(:div,
    \"hi\", title: escape_quotes(sanitize(user_input)))\n```\n"
  unaffected_versions:
  - < 3.0.0
  patched_versions:
  - ~> 3.2.22.3
  - ~> 4.2.7.1
  - ! '>= 5.0.0.1'
---
