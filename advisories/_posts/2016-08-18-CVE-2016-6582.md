---
layout: advisory
title: ! 'CVE-2016-6582 (doorkeeper): Doorkeeper gem does not revoke tokens & uses
  wrong auth/auth method'
comments: false
categories:
- doorkeeper
advisory:
  gem: doorkeeper
  cve: 2016-6582
  date: 2016-08-18
  url: https://github.com/doorkeeper-gem/doorkeeper/commit/fb938051777a3c9cb071e96fc66458f8f615bd53
  title: Doorkeeper gem does not revoke tokens & uses wrong auth/auth method
  description: ! "Doorkeeper failed to implement OAuth 2.0 Token Revocation (RFC 7009)
    in the\nfollowing ways:\n\n1. Public clients making valid, unauthenticated calls
    to revoke a token\n   would not have their token revoked\n2. Requests were not
    properly authenticating the *client credentials* but\n   were, instead, looking
    at the access token in a second location\n3. Because of 2, the requests were also
    not authorizing confidential\n   clients' ability to revoke a given token. It
    should only revoke tokens\n   that belong to it.\n\nThe security implication is:
    OAuth 2.0 clients who \"log out\" a user expect\nto have the corresponding access
    & refresh tokens revoked, preventing an\nattacker who may have already hijacked
    the session from continuing to\nimpersonate the victim. Because of the bug described
    above, this is not the\ncase. As far as OWASP is concerned, this counts as broken
    authentication\ndesign.\n\nMITRE has assigned CVE-2016-6582 due to the security
    issues raised. An\nattacker, thanks to 1, can replay a hijacked session after
    a victim logs\nout/revokes their token. Additionally, thanks to 2 & 3, an attacker
    via a\ncompromised confidential client could \"grief\" other clients by revoking\ntheir
    tokens (albeit this is an exceptionally narrow attack with little\nvalue).\n"
  unaffected_versions:
  - < 1.2.0
  patched_versions:
  - ! '>= 4.2.0'
---
